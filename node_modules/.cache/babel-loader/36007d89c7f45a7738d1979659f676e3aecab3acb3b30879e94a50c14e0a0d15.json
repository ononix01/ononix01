{"ast":null,"code":"import React,{useState}from'react';import{supabase}from'./supabaseClient';import{AuthError}from'@supabase/supabase-js';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function RegisterUser(_ref){let{onBack}=_ref;const[name,setName]=useState('');const[number,setNumber]=useState('');const[users,setUsers]=useState([]);const[message,setMessage]=useState('');const[showConfirm,setShowConfirm]=useState(true);const handleRegister=async()=>{if(!name||!number){setMessage('名前と番号を入力してください');return;}const{data:existing,error:fetchError}=await supabase.from('users').select('*').eq('manager_number',number);if(fetchError){console.error(fetchError);setMessage('確認中にエラーが発生しました');return;}if(existing.length>0){setMessage('この番号はすでに登録されています');return;}const{error}=await supabase.from('users').insert([{name,manager_number:number}]);if(error){console.error(error);setMessage('登録に失敗しました');}else{setMessage('登録が完了しました');setName('');setNumber('');}};const fetchUsers=async()=>{const{data,error}=await supabase.from('users').select('*');if(error){console.error(error);setMessage('ユーザー取得に失敗しました');}else{setUsers(data);setShowConfirm(false);}};const handleDelete=async id=>{await supabase.from('users').delete().eq('id',id);fetchUsers();};return/*#__PURE__*/_jsx(\"div\",{className:\"login-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u65B0\\u4EBA\\u767B\\u9332\"}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u540D\\u524D:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u7BA1\\u7406\\u756A\\u53F7:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:number,onChange:e=>setNumber(e.target.value)}),message&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red',marginTop:'0.5rem'},children:message}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:'1rem',marginTop:'1rem',flexWrap:'nowrap',overflowX:'auto'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleRegister,children:\"\\u767B\\u9332\"}),showConfirm&&/*#__PURE__*/_jsx(\"button\",{onClick:fetchUsers,children:\"\\u756A\\u53F7\\u78BA\\u8A8D\"})]}),users.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'1.5rem',display:'flex',alignItems:'center',gap:'1rem'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'auto'},children:\"\\u767B\\u9332\\u4E00\\u89A7\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchUsers,style:{fontSize:'0.75rem',padding:'0.2rem 0.4rem',// 横パディングを少し狭く\ncursor:'pointer',height:'24px',minWidth:'auto',// 幅を自動調整\nwidth:'auto',whiteSpace:'nowrap'// テキストを1行に固定\n},title:\"\\u4E00\\u89A7\\u3092\\u66F4\\u65B0\",children:\"\\u66F4\\u65B0\"})]}),/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse',textAlign:'left',marginTop:'6.0rem'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{borderBottom:'1px solid #ccc'},children:\"\\u7BA1\\u7406\\u756A\\u53F7\"}),/*#__PURE__*/_jsx(\"th\",{style:{borderBottom:'1px solid #ccc'},children:\"\\u540D\\u524D\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.manager_number}),/*#__PURE__*/_jsx(\"td\",{children:user.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(user.id),style:{backgroundColor:'#e74c3c',color:'white',border:'none',padding:'0.3rem 0.6rem',borderRadius:'4px',cursor:'pointer'},children:\"\\u524A\\u9664\"})})]},user.id))})]})]})]})});}export default RegisterUser;","map":{"version":3,"names":["React","useState","supabase","AuthError","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RegisterUser","_ref","onBack","name","setName","number","setNumber","users","setUsers","message","setMessage","showConfirm","setShowConfirm","handleRegister","data","existing","error","fetchError","from","select","eq","console","length","insert","manager_number","fetchUsers","handleDelete","id","delete","className","children","type","value","onChange","e","target","style","color","marginTop","display","justifyContent","gap","flexWrap","overflowX","onClick","alignItems","margin","fontSize","padding","cursor","height","minWidth","width","whiteSpace","title","borderCollapse","textAlign","borderBottom","map","user","backgroundColor","border","borderRadius"],"sources":["C:/Users/kouki/my-app/src/RegisterUser.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { supabase } from './supabaseClient';\r\nimport { AuthError } from '@supabase/supabase-js';\r\n\r\nfunction RegisterUser({ onBack }) {\r\n  const [name, setName] = useState('');\r\n  const [number, setNumber] = useState('');\r\n  const [users, setUsers] = useState([]);\r\n  const [message, setMessage] = useState('');\r\n  const [showConfirm, setShowConfirm] = useState(true);\r\n\r\n  const handleRegister = async () => {\r\n    if (!name || !number) {\r\n      setMessage('名前と番号を入力してください');\r\n      return;\r\n    }\r\n\r\n    const { data: existing, error: fetchError } = await supabase\r\n      .from('users')\r\n      .select('*')\r\n      .eq('manager_number', number);\r\n\r\n    if (fetchError) {\r\n      console.error(fetchError);\r\n      setMessage('確認中にエラーが発生しました');\r\n      return;\r\n    }\r\n\r\n    if (existing.length > 0) {\r\n      setMessage('この番号はすでに登録されています');\r\n      return;\r\n    }\r\n\r\n    const { error } = await supabase\r\n      .from('users')\r\n      .insert([{ name, manager_number: number }]);\r\n\r\n    if (error) {\r\n      console.error(error);\r\n      setMessage('登録に失敗しました');\r\n    } else {\r\n      setMessage('登録が完了しました');\r\n      setName('');\r\n      setNumber('');\r\n    }\r\n  };\r\n\r\n  const fetchUsers = async () => {\r\n    const { data, error } = await supabase\r\n      .from('users')\r\n      .select('*');\r\n\r\n    if (error) {\r\n      console.error(error);\r\n      setMessage('ユーザー取得に失敗しました');\r\n    } else {\r\n      setUsers(data);\r\n      setShowConfirm(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    await supabase.from('users').delete().eq('id', id);\r\n    fetchUsers();\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-wrapper\">\r\n      <div className=\"login-card\">\r\n        <h2>新人登録</h2>\r\n\r\n        <label>名前:</label>\r\n        <input\r\n          type=\"text\"\r\n          value={name}\r\n          onChange={e => setName(e.target.value)}\r\n        />\r\n\r\n        <label>管理番号:</label>\r\n        <input\r\n          type=\"text\"\r\n          value={number}\r\n          onChange={e => setNumber(e.target.value)}\r\n        />\r\n\r\n        {message && <p style={{ color: 'red', marginTop: '0.5rem' }}>{message}</p>}\r\n\r\n        <div style={{\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          gap: '1rem',\r\n          marginTop: '1rem',\r\n          flexWrap: 'nowrap',\r\n          overflowX: 'auto',\r\n        }}>\r\n          <button onClick={handleRegister}>登録</button>\r\n          {showConfirm && <button onClick={fetchUsers}>番号確認</button>}\r\n        </div>\r\n\r\n        {users.length > 0 && (\r\n          <>\r\n            <div style={{\r\n              marginTop: '1.5rem',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '1rem',\r\n            }}>\r\n              <h4 style={{ margin:'auto' }}>登録一覧</h4>\r\n              <button\r\n  onClick={fetchUsers}\r\n  style={{\r\n    fontSize: '0.75rem',\r\n    padding: '0.2rem 0.4rem',  // 横パディングを少し狭く\r\n    cursor: 'pointer',\r\n    height: '24px',\r\n    minWidth: 'auto',          // 幅を自動調整\r\n    width: 'auto',\r\n    whiteSpace: 'nowrap',      // テキストを1行に固定\r\n  }}\r\n  title=\"一覧を更新\"\r\n>\r\n  更新\r\n</button>\r\n\r\n            </div>\r\n\r\n            <table style={{\r\n              width: '100%',\r\n              borderCollapse: 'collapse',\r\n              textAlign: 'left',\r\n              marginTop: '6.0rem'\r\n            }}>\r\n              <thead>\r\n                <tr>\r\n                  <th style={{ borderBottom: '1px solid #ccc' }}>管理番号</th>\r\n                  <th style={{ borderBottom: '1px solid #ccc' }}>名前</th>\r\n                  <th></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {users.map(user => (\r\n                  <tr key={user.id}>\r\n                    <td>{user.manager_number}</td>\r\n                    <td>{user.name}</td>\r\n                    <td>\r\n                      <button onClick={() => handleDelete(user.id)} style={{\r\n                        backgroundColor: '#e74c3c',\r\n                        color: 'white',\r\n                        border: 'none',\r\n                        padding: '0.3rem 0.6rem',\r\n                        borderRadius: '4px',\r\n                        cursor: 'pointer'\r\n                      }}>\r\n                        削除\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RegisterUser;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}